from typing import Any, List, NamedTuple, Optional, Union
from fmeval.reporting.cells import (
    MarkdownCell,
    FigureCell,
    TableCell,
    BarPlotCell,
    HeadingCell,
    BoldCell,
    ListCell,
    ListType,
    ColumnsLayoutCell,
)
from fmeval.reporting.constants import CENTER, LEFT, RIGHT

import matplotlib.pyplot as plt
import pytest


def get_num_table_rows(html: str) -> int:
    """
    Returns the number of table rows present in `html`.

    Helper method for test function below.

    :param html: The HTML code for a table
    :returns: The number of rows (including the header) in the table
    """
    return html.count("<tr>")


class TestCell:
    # Hard-coded base64 strings corresponding to different test cases
    FIGURE_CELL_NO_ARGS = "<br><img style=\"display: block;margin-left:auto; margin-right: auto;\" src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAApQAAAHzCAYAAACe1o1DAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAJJElEQVR4nO3WwQ3AIBDAsNL9dz52IA+EZE+QZ9bMzAcAAIf+2wEAALzNUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQbIkuB+K/CZ+IAAAAAElFTkSuQmCC'><br>"
    FIGURE_CELL_WITH_ARGS = "<br><img style=\"display: block;width:200; height:100;\" src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAApQAAAHzCAYAAACe1o1DAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAJJElEQVR4nO3WwQ3AIBDAsNL9dz52IA+EZE+QZ9bMzAcAAIf+2wEAALzNUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQGEoAABJDCQBAYigBAEgMJQAAiaEEACAxlAAAJIYSAIDEUAIAkBhKAAASQwkAQGIoAQBIDCUAAImhBAAgMZQAACSGEgCAxFACAJAYSgAAEkMJAEBiKAEASAwlAACJoQQAIDGUAAAkhhIAgMRQAgCQbIkuB+K/CZ+IAAAAAElFTkSuQmCC'><br>"
    BAR_PLOT_CELL_NO_ARGS = "<br><img style=\"display: block;margin-left:auto; margin-right: auto;\" src='data:image/png;base64,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'><br>"
    BAR_PLOT_CELL_WITH_ARGS = "<br><img style=\"display: block;margin-left:auto; margin-right: auto;\" src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAnUAAAHXCAYAAADay6wsAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8fJSN1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAnFElEQVR4nO3de5jVdYHH8c9wC9xEMbkYeEu8QIooXhjdTWlJV7wwtabSU4ArWhuYSj2WrYmpRZuamhnWtkpZaNoK7ppoiKJrUHmBFjFdK4FyHcBWWSGFkTn7h09T4zDgzAAzfnm9nmeex/nN93d+3zPD9/ie35zzO1WVSqUSAADe1jq19wQAAGg7UQcAUABRBwBQAFEHAFAAUQcAUABRBwBQAFEHAFAAUQcAUABRBwBQAFEHbHNVVVW59NJL23saW9Vee+2V8ePHt/c0Gtkevu+wPRN1QJtNnz49VVVVjT769OmTESNGZPbs2e09vQ7tzd+3nj175phjjsmPf/zj9p4a8DbTpb0nAJTjsssuy957751KpZIVK1Zk+vTpGTVqVP7jP/4jJ510UntPr8P6wAc+kLFjx6ZSqWTZsmWZNm1aTj755MyePTvHH398e08PeJsQdcAWc8IJJ+Swww5r+Pyss85K3759c+utt4q6Tdhvv/3y0Y9+tOHzv//7v8/gwYNz3XXXiTrgLfPnV2Cr2XnnndOjR4906bLp3x/Hjx+fvfbaq8n2Sy+9NFVVVU22f//738+wYcPSo0eP7LLLLjnjjDPyu9/9brPzWbZsWT75yU9m//33T48ePfKud70rH/7wh7N06dJG4/705+Sf/vSnmTx5cnr37p2/+qu/ygc/+MGsWrWq0dhKpZIrrrgiAwYMyA477JARI0ZkyZIlm53LpgwaNCi77rprfvOb3zTavm7dukyZMiUDBw7MO97xjuy+++658MILs27duibjLrjggvTu3Ts77rhjTjnllPz+979v05yAjs+ZOmCLWb16dV588cVUKpWsXLky119/fdasWdPoLFRbfelLX8oXvvCFnHbaaZkwYUJWrVqV66+/Pu973/uycOHC7Lzzzs3u++ijj2b+/Pk544wzMmDAgCxdujTTpk3Lsccem6eeeio77LBDo/HnnntuevXqlSlTpmTp0qW59tprM2nSpPzwhz9sGHPJJZfkiiuuyKhRozJq1Kg88cQTOe6447J+/fpW38fVq1fnpZdeyj777NOwrb6+PqecckoeeeSRnHPOORk0aFAWL16ca665Jv/93/+dWbNmNYydMGFCvv/97+cjH/lIjjrqqDzwwAM58cQTWz0f4G2iAtBGN998cyVJk493vOMdlenTpzcZn6QyZcqUhs/HjRtX2XPPPZuMmzJlSuUvH6aWLl1a6dy5c+VLX/pSo3GLFy+udOnSpcn2N/vjH//YZNuCBQsqSSrf+973mtyfkSNHVurr6xu2X3DBBZXOnTtXXn755UqlUqmsXLmy0q1bt8qJJ57YaNznP//5SpLKuHHjNjmfSuWN78VZZ51VWbVqVWXlypWVxx57rPJ3f/d3lSSVK6+8smHcLbfcUunUqVPlP//zPxvtf+ONN1aSVH76059WKpVKZdGiRZUklU9+8pONxn3kIx9p8n0HyuLPr8AWc8MNN2TOnDmZM2dOvv/972fEiBGZMGFC7rzzzi1y+3feeWfq6+tz2mmn5cUXX2z46NevX/bdd988+OCDm9y/R48eDf9dV1eXP/zhDxk4cGB23nnnPPHEE03Gn3POOY3+/Ps3f/M32bBhQ5YtW5Ykuf/++7N+/fqce+65jcadf/75Lbpf//qv/5revXunT58+OeywwzJ37txceOGFmTx5csOYO+64I4MGDcoBBxzQ6L6///3vT5KG+37PPfckST71qU81OkZL5wS8/fjzK7DFHHHEEY1eKDFmzJgccsghmTRpUk466aR069atTbf/7LPPplKpZN99993o17t27brJ/V999dVMnTo1N998c55//vlUKpWGr61evbrJ+D322KPR57169UqSvPTSS0nSEHdvnk/v3r0bxr4Vo0ePzqRJk7J+/fo8+uij+fKXv5w//vGP6dTpz793P/vss/nVr36V3r17b/Q2Vq5c2TCnTp06NfrTbZLsv//+b3k+wNuTqAO2mk6dOmXEiBG57rrr8uyzz+a9733vRsdt7MUQSbJhw4ZGn9fX16eqqiqzZ89O586dm4x/5zvfucn5nHvuubn55ptz/vnnp7q6OjvttFOqqqpyxhlnpL6+vsn4jR0jSaMY3BIGDBiQkSNHJklGjRqVXXfdNZMmTcqIESPyoQ99KMkb9/2ggw7K1772tY3exu67775F5wS8/Yg6YKt6/fXXkyRr1qxpdkyvXr3y8ssvN9n+pzNhf7LPPvukUqlk7733zn777dfiufzoRz/KuHHjcvXVVzdse+211zZ67Ldizz33TPLGWbT3vOc9DdtXrVrVcDavNT7+8Y/nmmuuycUXX5wPfvCDqaqqyj777JNf/vKX+du//dtmI/hPc6qvr89vfvObRmfnnnnmmVbPB3h78Jw6YKupq6vLT37yk3Tr1i2DBg1qdtw+++yT1atX57/+678atr3wwguZOXNmo3Ef+tCH0rlz53zxi19scrasUqnkD3/4wybn07lz5yb7XX/99U3OCL5VI0eOTNeuXXP99dc3ut1rr722Vbf3J126dMmnP/3p/OpXv8pdd92VJDnttNPy/PPP51/+5V+ajH/11Vezdu3aJG9cKzBJvv71rzca09Y5AR2fM3XAFjN79uw8/fTTSd54jteMGTPy7LPP5nOf+1x69uzZ7H5nnHFGPvvZz+aDH/xgPvWpT+WPf/xjpk2blv3226/RCxj22WefXHHFFbnooouydOnS1NTUZMcdd8xzzz2XmTNn5pxzzslnPvOZZo9z0kkn5ZZbbslOO+2UwYMHZ8GCBbn//vvzrne9q1X3t3fv3vnMZz6TqVOn5qSTTsqoUaOycOHCzJ49O7vuumurbvNPxo8fn0suuST//M//nJqamnzsYx/L7bffnk984hN58MEHc/TRR2fDhg15+umnc/vtt+e+++7LYYcdlqFDh2bMmDH55je/mdWrV+eoo47K3Llz8+tf/7pN8wE6PlEHbDGXXHJJw3937949BxxwQKZNm5aPf/zjm9zvXe96V2bOnJnJkyfnwgsvzN57752pU6fm2WefbfKq1M997nPZb7/9cs011+SLX/xikjeeT3bcccfllFNO2eRxrrvuunTu3Dk/+MEP8tprr+Xoo4/O/fff36Z3bbjiiivSvXv33HjjjXnwwQdz5JFH5ic/+UmbrwvXo0ePTJo0KZdeemnmzZuXY489NrNmzco111yT733ve5k5c2Z22GGHvOc978l5553X6M/RN910U3r37p0f/OAHmTVrVt7//vfnxz/+sefdQeGqKlv6Gb8AAGxznlMHAFAAUQcAUABRBwBQgBZF3bRp0zJkyJD07NkzPXv2THV1dWbPnt3s+OnTp6eqqqrRR/fu3ds8aQAAGmvRq18HDBiQr3zlK9l3331TqVTy3e9+N6NHj87ChQubvVJ8z549G130clMXzQQAoHVaFHUnn3xyo8+/9KUvZdq0afnZz362ybf/6devX+tnCADAZrX6OXUbNmzIbbfdlrVr16a6urrZcWvWrMmee+6Z3XffPaNHj86SJUtae0gAAJrR4osPL168ONXV1Xnttdfyzne+MzNnzszgwYM3Onb//ffPTTfdlCFDhmT16tW56qqrctRRR2XJkiUZMGBAs8f409viAACQjB49erNjWnzx4fXr12f58uVZvXp1fvSjH+U73/lOHnrooWbD7i/V1dVl0KBBGTNmTC6//PJNjgMA4A1du3bd7Jg2v6PEyJEjs88+++Rb3/rWWxr/4Q9/OF26dMmtt97alsMCAPAX2nyduvr6+qxbt+4tjd2wYUMWL16c3Xbbra2HBQDgL7ToOXUXXXRRTjjhhOyxxx555ZVXMmPGjMybNy/33XdfkmTs2LHp379/pk6dmiS57LLLMnz48AwcODAvv/xyrrzyyixbtiwTJkzY8vcEAGA71qKoW7lyZcaOHZsXXnghO+20U4YMGZL77rsvH/jAB5Iky5cvT6dOfz7599JLL+Xss89ObW1tevXqlWHDhmX+/Plv6fl3AAC8dW1+Th0AAO3Pe78CABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFEDUAQAUQNQBABRA1AEAFKBFUTdt2rQMGTIkPXv2TM+ePVNdXZ3Zs2dvcp877rgjBxxwQLp3756DDjoo99xzT5smDABAUy2KugEDBuQrX/lKHn/88Tz22GN5//vfn9GjR2fJkiUbHT9//vyMGTMmZ511VhYuXJiamprU1NTkySef3CKTBwDgDVWVSqXSlhvYZZddcuWVV+ass85q8rXTTz89a9euzd13392wbfjw4Rk6dGhuvPHGthwWAIC/0KW1O27YsCF33HFH1q5dm+rq6o2OWbBgQSZPntxo2/HHH59Zs2Zt8rbr6upaOy0AgOJ07dp1s2NaHHWLFy9OdXV1Xnvttbzzne/MzJkzM3jw4I2Ora2tTd++fRtt69u3b2prazd5DM+7A4COZXRNTXtPocO5azMnqbak0aNHb3ZMi6Nu//33z6JFi7J69er86Ec/yrhx4/LQQw81G3atMWrUqC12WwAAW0NH65UWR123bt0ycODAJMmwYcPy6KOP5rrrrsu3vvWtJmP79euXFStWNNq2YsWK9OvXb5PHeCunGAEA2lNH65U2X6euvr4+69at2+jXqqurM3fu3Ebb5syZ0+xz8AAAaJ0Wnam76KKLcsIJJ2SPPfbIK6+8khkzZmTevHm57777kiRjx45N//79M3Xq1CTJeeedl2OOOSZXX311TjzxxNx222157LHH8u1vf3vL3xMAgO1Yi6Ju5cqVGTt2bF544YXstNNOGTJkSO6777584AMfSJIsX748nTr9+eTfUUcdlRkzZuTiiy/O5z//+ey7776ZNWtWDjzwwC17LwAAtnNtvk4dALAdqKpq7xl0PB0sobz3KwBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABWhR1U6dOzeGHH54dd9wxffr0SU1NTZ555plN7jN9+vRUVVU1+ujevXubJg0AQGMtirqHHnooEydOzM9+9rPMmTMndXV1Oe6447J27dpN7tezZ8+88MILDR/Lli1r06QBAGisS0sG33vvvY0+nz59evr06ZPHH38873vf+5rdr6qqKv369WvdDAEA2Kw2Padu9erVSZJddtllk+PWrFmTPffcM7vvvntGjx6dJUuWtOWwAAC8SVWlUqm0Zsf6+vqccsopefnll/PII480O27BggV59tlnM2TIkKxevTpXXXVVHn744SxZsiQDBgzY6D51dXWtmRIAsJV07datvafQ4dStX7/NjtW1a9fNjml11P3jP/5jZs+enUceeaTZONuYurq6DBo0KGPGjMnll1++0TF33XVXa6YEAGwlo2tq2nsKHc5ds2Zts2ONHj16s2NaFXWTJk3KXXfdlYcffjh77713iyf24Q9/OF26dMmtt9660a87UwcAHYszdU11tDN1LXqhRKVSybnnnpuZM2dm3rx5rQq6DRs2ZPHixRk1alSzY97KxAEA2lNH65UWRd3EiRMzY8aM3HXXXdlxxx1TW1ubJNlpp53So0ePJMnYsWPTv3//TJ06NUly2WWXZfjw4Rk4cGBefvnlXHnllVm2bFkmTJiwhe8KAMD2q0VRN23atCTJscce22j7zTffnPHjxydJli9fnk6d/vyi2pdeeilnn312amtr06tXrwwbNizz58/P4MGD2zZzAAAatPqFEgDAdqSqqr1n0PF0sITy3q8AAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABWhR1E2dOjWHH354dtxxx/Tp0yc1NTV55plnNrvfHXfckQMOOCDdu3fPQQcdlHvuuafVEwYAoKkWRd1DDz2UiRMn5mc/+1nmzJmTurq6HHfccVm7dm2z+8yfPz9jxozJWWedlYULF6ampiY1NTV58skn2zx5AADeUFWpVCqt3XnVqlXp06dPHnroobzvfe/b6JjTTz89a9euzd13392wbfjw4Rk6dGhuvPHG1h4aANiWqqraewYdT+sTaqto03PqVq9enSTZZZddmh2zYMGCjBw5stG2448/PgsWLGjLoQEA+AtdWrtjfX19zj///Bx99NE58MADmx1XW1ubvn37NtrWt2/f1NbWNrtPXV1da6cFAGwFXdt7Ah3QtuyVrl03/xNoddRNnDgxTz75ZB555JHW3kSzvJACtm81NaPbewodzqxZd7X3FNjOWZVNbcteGT168z+BVkXdpEmTcvfdd+fhhx/OgAEDNjm2X79+WbFiRaNtK1asSL9+/ZrdZ9SoUa2ZFkCxPC5Cx9PR1mWLoq5SqeTcc8/NzJkzM2/evOy9996b3ae6ujpz587N+eef37Btzpw5qa6ubnaft3KKEWB74nEROp6Oti5bFHUTJ07MjBkzctddd2XHHXdseF7cTjvtlB49eiRJxo4dm/79+2fq1KlJkvPOOy/HHHNMrr766px44om57bbb8thjj+Xb3/72Fr4rAADbrxZd0qSqmZcz33zzzRk/fnyS5Nhjj81ee+2V6dOnN3z9jjvuyMUXX5ylS5dm3333zVe/+tUOd8oS6DhcOaGpDnblBLZHFmZTHWxhtuk6dQBbg/93NOWRmnZnYTbVwRam934FACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAogKgDACiAqAMAKICoAwAoQIuj7uGHH87JJ5+cd7/73amqqsqsWbM2OX7evHmpqqpq8lFbW9vaOQMA8CYtjrq1a9fm4IMPzg033NCi/Z555pm88MILDR99+vRp6aEBAGhGl5bucMIJJ+SEE05o8YH69OmTnXfeucX7AQCweS2OutYaOnRo1q1blwMPPDCXXnppjj766GbH1tXVbatpAR1S1/aeQIfjcZH2ZlU2tS3XZdeum/8JbPWo22233XLjjTfmsMMOy7p16/Kd73wnxx57bH7+85/n0EMP3eg+99xzz9aeFtChjW7vCXQ4Hhdpb1ZlU9tyXY4evfmfQFWlUqm09gBVVVWZOXNmampqWrTfMccckz322CO33HLLRr/uN1LYvnXr5pzAm61f73GR9tW1W7f2nkKHU7d+/TY7Voc4U7cxRxxxRB555JFmv/5WJg6wPfG4CB1PR1uX7XKdukWLFmW33XZrj0MDABSpxWfq1qxZk1//+tcNnz/33HNZtGhRdtlll+yxxx656KKL8vzzz+d73/tekuTaa6/N3nvvnfe+97157bXX8p3vfCcPPPBAfvKTn2y5ewEAsJ1rcdQ99thjGTFiRMPnkydPTpKMGzcu06dPzwsvvJDly5c3fH39+vX59Kc/neeffz477LBDhgwZkvvvv7/RbQAA0DZteqEEwNZQVdXeM+h4PFLT7izMpjrYwvTerwAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFaHHUPfzwwzn55JPz7ne/O1VVVZk1a9Zm95k3b14OPfTQvOMd78jAgQMzffr0VkwVAIDmtDjq1q5dm4MPPjg33HDDWxr/3HPP5cQTT8yIESOyaNGinH/++ZkwYULuu+++Fk8WAICNq6pUKpVW71xVlZkzZ6ampqbZMZ/97Gfz4x//OE8++WTDtjPOOCMvv/xy7r333tYeGihYVVV7z6Djaf0jNWwhFmZTHWxhdtnaB1iwYEFGjhzZaNvxxx+f888/v9l96urqtvKsgI6ta3tPoMPxuEh7syqb2pbrsmvXzf8EtnrU1dbWpm/fvo229e3bN//3f/+XV199NT169Giyzz333LO1p5UkqakZvU2O83Yya9Zd7T0FSGJtvtm2elyE5liVTW3LdTl69OZ/Als96lpj1KhR7T2F7ZbvPXRM1iZ0PB1tXW71qOvXr19WrFjRaNuKFSvSs2fPjZ6lS97aKUa2Dt976JisTeh4Otq63OrXqauurs7cuXMbbZszZ06qq6u39qEBALYbLY66NWvWZNGiRVm0aFGSNy5ZsmjRoixfvjxJctFFF2Xs2LEN4z/xiU/kt7/9bS688MI8/fTT+eY3v5nbb789F1xwwZa5BwAAtPySJvPmzcuIESOabB83blymT5+e8ePHZ+nSpZk3b16jfS644II89dRTGTBgQL7whS9k/PjxbZ17m3l1dlMd7NXZbKeszaasTdqdhdlUB1uYbbpO3dudf59Nbb//GuhIrM2mrE3anYXZVAdbmN77FQCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAAog4AoACiDgCgAKIOAKAArYq6G264IXvttVe6d++eI488Mr/4xS+aHTt9+vRUVVU1+ujevXurJwwAQFMtjrof/vCHmTx5cqZMmZInnngiBx98cI4//visXLmy2X169uyZF154oeFj2bJlbZo0AACNtTjqvva1r+Xss8/OmWeemcGDB+fGG2/MDjvskJtuuqnZfaqqqtKvX7+Gj759+7Zp0gAANNalJYPXr1+fxx9/PBdddFHDtk6dOmXkyJFZsGBBs/utWbMme+65Z+rr63PooYfmy1/+ct773vc2O76urq4l02qDrtvoOG8f2+57D5tibb6ZtUl7syqb2pbrsmvXzf8EWhR1L774YjZs2NDkTFvfvn3z9NNPb3Sf/fffPzfddFOGDBmS1atX56qrrspRRx2VJUuWZMCAARvd55577mnJtNpg9DY6ztvHtvvew6ZYm29mbdLerMqmtuW6HD168z+BqkqlUnmrN/g///M/6d+/f+bPn5/q6uqG7RdeeGEeeuih/PznP9/sbdTV1WXQoEEZM2ZMLr/88mbHbAvduvm9483Wr3c2gPZnbTZlbdLeunbr1t5T6HDq1q/fZsfa4mfqdt1113Tu3DkrVqxotH3FihXp16/fW57UIYcckl//+tebHEP78L2HjsnahI6no63LFr1Qolu3bhk2bFjmzp3bsK2+vj5z585tdOZuUzZs2JDFixdnt912a9lMAQBoVovO1CXJ5MmTM27cuBx22GE54ogjcu2112bt2rU588wzkyRjx45N//79M3Xq1CTJZZddluHDh2fgwIF5+eWXc+WVV2bZsmWZMGHClr0nAADbsRZH3emnn55Vq1blkksuSW1tbYYOHZp777234cUTy5cvT6dOfz4B+NJLL+Xss89ObW1tevXqlWHDhmX+/PkZPHjwlrsXAADbuRa9UKI0VVXtPYOOZ/v910BHYm02ZW3S7izMpjrYwvTerwAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFEHUAAAUQdQAABRB1AAAFaFXU3XDDDdlrr73SvXv3HHnkkfnFL36xyfF33HFHDjjggHTv3j0HHXRQ7rnnnlZNFgCAjWtx1P3whz/M5MmTM2XKlDzxxBM5+OCDc/zxx2flypUbHT9//vyMGTMmZ511VhYuXJiamprU1NTkySefbPPkAQB4Q1WlUqm0ZIcjjzwyhx9+eL7xjW8kSerr67P77rvn3HPPzec+97km408//fSsXbs2d999d8O24cOHZ+jQobnxxhvbOP22qapq18N3SC371wBbh7XZlLVJu7Mwm+pgC7NFZ+rWr1+fxx9/PCNHjvzzDXTqlJEjR2bBggUb3WfBggWNxifJ8ccf3+x4AABarktLBr/44ovZsGFD+vbt22h737598/TTT290n9ra2o2Or62tbfY4dXV1LZlWG3TdRsd5+9h233vYFGvzzaxN2ptV2dS2XJddu27+J9CiqNtW3srEt4QOdta0g7BsaX/W5sZYm7QzC7OJjrYqW/Tn11133TWdO3fOihUrGm1fsWJF+vXrt9F9+vXr16LxAAC0XIuirlu3bhk2bFjmzp3bsK2+vj5z585NdXX1Rveprq5uND5J5syZ0+x4AABarsV/fp08eXLGjRuXww47LEcccUSuvfbarF27NmeeeWaSZOzYsenfv3+mTp2aJDnvvPNyzDHH5Oqrr86JJ56Y2267LY899li+/e1vb9l7AgCwHWtx1J1++ulZtWpVLrnkktTW1mbo0KG59957G14MsXz58nTq9OcTgEcddVRmzJiRiy++OJ///Oez7777ZtasWTnwwAO33L0AANjOtfg6dQAAdDze+xUAoACiDtgurFq1KkmyYcOGbNiwodHX/MECOp5XX321vafwtiPqtoGlS5fm5ptvzuOPP57XX3+9vacD250rrrgi55xzTp577rl07tw5nTt3zvPPP59HH300dXV1qfL2R9BhPPvss/mHf/iHXH311Vm/fn17T+dtRdRtRRs2bMinPvWpHHLIIbn22mszevTonHrqqa4MD9vYCSeckOXLl+fee+9Nkpx//vnZd999c+qpp+aEE07ID37wg3aeIZC88QvYkCFD8vrrr2fvvfduOMPOW9Mh31GiBGvWrMnll1+ehQsX5v7778+wYcPy+9//PnvssUe++c1vZtKkSencuXN7TxO2C8OGDcvw4cPz4IMP5pVXXslvf/vbPPDAA3nllVdy2223ZeLEidlvv/1y+OGHt/dUYbv1y1/+Mv/2b/+WW2+9NTU1Ne09nbclUbeVdOrUKfvvv3/Gjx+fQYMG5YEHHsg//dM/pWvXrvnqV7+aY489NgcffHB7TxO2G1OmTMmoUaPy+OOPZ+LEiRk+fHiSZMiQIfnf//3ffOITn8jjjz/ezrOE7deDDz6Y1atX58gjj2zY9qfnu3qKxFvjz69byQ477JCampoMGjQoV1xxRc4888wce+yx+cMf/pDOnTvnG9/4hieBwjbUp0+fnH322Vm6dGl69OjRsL13794599xzs2zZsibvfgNsO7W1tenZs2f69u3bKOaqqqpSX1/fzrN7exB1W9Euu+yS5cuX59///d8zZcqUTJ06NT169Mhee+2VO++8M/fdd197TxG2K2eeeWYOO+yw/PSnP83KlSuTvHFWvV+/funVq1fWrl3bzjOE7depp56axYsX56GHHmo4M1epVPLiiy/m9ttvb+fZvT2Iuq3ssccey1NPPZW//uu/TvLGK2H322+/7LzzznniiSdcSgG2oW7duuXyyy/PkiVLMmPGjIbtr776atasWZP+/fu34+xg+3bwwQdnzJgxmTBhQhYuXJg1a9Zk7dq1+frXv54777wzy5cvb+8pdnjeUWIrW7duXd797nfnkEMOaXjLtLFjx+bCCy9M9+7d23t6sN2pVCo59dRTM2fOnJxxxhkZPHhwrrrqqgwdOjS33HJLevXq1d5ThO3WunXrcswxx+R3v/td9tlnn/z+979Pp06d8t3vfjdHH310e0+vwxN128DcuXNz880356mnnsrHPvaxXHDBBe09JdiuPffcc6murs7++++fQw89NAMHDszEiRPbe1pA3rhQ+OLFi7No0aL06dMnH/3oR9t7Sm8bom4bef3111NVVeUyJtBBnHfeeamurs5pp52WTp08EwV4+xN1wHapvr5ezAFFEXUAAAXwayoAQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAUQdAEABRB0AQAFEHQBAAf4fStL4X1e7s/0AAAAASUVORK5CYII='><br>"

    class TestCaseMarkdownInit(NamedTuple):
        args: List[Union[str, MarkdownCell]]
        expected: Optional[str] = None

    @pytest.mark.parametrize(
        "args, expected",
        [
            TestCaseMarkdownInit(
                args=["# Title", "## Header", "Some text"], expected="# Title  \n\n## Header  \n\nSome text"
            ),
            TestCaseMarkdownInit(
                args=["# Title", MarkdownCell("## Header", "Some text")],
                expected="# Title  \n\n## Header  \n\nSome text",
            ),
        ],
    )
    def test_markdown_cell_init_success(self, args, expected):
        """
        GIVEN valid arguments to the MarkdownCell initializer
        WHEN a MarkdownCell object is created
        THEN the str representation of the initialized MarkdownCell
            matches what is expected
        """
        md = MarkdownCell(*args)
        assert str(md) == expected

    @pytest.mark.parametrize(
        "args",
        [
            TestCaseMarkdownInit(args=["# Title", "## Header", 123]),
            TestCaseMarkdownInit(args=[["## Header", "Some text"]]),
            TestCaseMarkdownInit(args=["# Title", ["## Header", "Some text"]]),
        ],
    )
    def test_markdown_cell_init_failure(self, args):
        """
        GIVEN an input that is not a string or MarkdownCell
        WHEN a MarkdownCell object is created
        THEN an exception is raised
        """
        with pytest.raises(AssertionError):
            MarkdownCell(*args)

    @pytest.mark.parametrize("level", [1, 2, 3])
    def test_heading_cell_init(self, level):
        """
        GIVEN valid arguments
        WHEN a HeadingCell is created
        THEN the str representation of the HeadingCell matches what is expected
        """
        heading_cell = HeadingCell("Some text.", level=level)
        assert str(heading_cell) == f"{'#' * level} Some text."

    def test_bold_cell_init(self):
        """
        GIVEN a valid argument
        WHEN a BoldCell is created
        THEN the str representation of the BoldCell matches what is expected
        """
        bold_cell = BoldCell("Some text.")
        assert str(bold_cell) == "**Some text.**"

    @pytest.mark.parametrize(
        "list_type, expected_output",
        [
            (ListType.NUMBERED, "1. Item 1  \n2. Item 2  \n3. Item 3"),
            (ListType.BULLETED, "* Item 1  \n* Item 2  \n* Item 3"),
        ],
    )
    def test_list_cell_init(self, list_type, expected_output):
        """
        GIVEN valid parameters to ListCell
        WHEN a ListCell is created
        THEN the str representation of the ListCell matches what is expected
        """
        list_items = ["Item 1", "Item 2", "Item 3"]
        list_cell = ListCell(items=list_items, list_type=list_type)
        assert str(list_cell) == expected_output

    def test_column_layout_cell_init(self):
        """
        GIVEN valid parameters to ColumnsLayoutCell
        WHEN a ColumnsLayoutCell is created
        THEN the str representation of the ColumnsLayoutCell matches what is expected
        """
        cols = [["Item 1", "Item 2"], ["Item 3", "Item 4"]]
        cols_cell = ColumnsLayoutCell(cols)
        expected_output = '<div class="row" markdown="1">  \n\n<div class="column" markdown="1" style="float: left;width: 50%;">\nItem 1  \nItem 2  \n</div><div class="column" markdown="1" style="float: left;width: 50%;">\nItem 3  \nItem 4  \n</div>  \n\n</div>  \n\n <br style="clear:both" />'
        assert str(cols_cell) == expected_output

    class TestCaseFigureCellInit(NamedTuple):
        args: List[Union[int, str]]
        expected: str

    @pytest.mark.parametrize(
        "args, expected",
        [
            TestCaseFigureCellInit(
                args=[],
                expected=FIGURE_CELL_NO_ARGS,
            ),
            TestCaseFigureCellInit(
                args=["200", "100", False],
                expected=FIGURE_CELL_WITH_ARGS,
            ),
        ],
    )
    def test_figure_cell_init(self, args, expected):
        """
        GIVEN a Pyplot Figure object is passed to FigureCell initializer
        WHEN a FigureCell is created
        THEN the FigureCell's string representation matches what is expected
        """
        plt_fig = plt.figure()
        figure = FigureCell(plt_fig, *args)
        assert str(figure) == expected

    class TestCaseTableCellInit(NamedTuple):
        data: List[List[Any]]
        headers: List[str]

    @pytest.mark.parametrize("style", ["table-layout: fixed;", None])
    @pytest.mark.parametrize("caption", ["Table caption", None])
    @pytest.mark.parametrize("cell_align", [CENTER, LEFT, RIGHT])
    @pytest.mark.parametrize("table_align", [CENTER, LEFT, RIGHT])
    @pytest.mark.parametrize(
        "data, headers",
        [
            TestCaseTableCellInit(
                data=[[1, 2, 3], [4, 5, 6]],
                headers=["col_1", "col_2", "col_3"],
            ),
            TestCaseTableCellInit(
                data=[["a", "b", "c"], ["d", "e", "f"]],
                headers=["col_1", "col_2", "col_3"],
            ),
        ],
    )
    def test_table_cell_init_success(self, data, headers, table_align, cell_align, caption, style):
        """
        GIVEN valid `data` and `headers` arguments
        WHEN a TableCell is created
        THEN TableCell's __str__ method returns the expected HTML
        """
        table = TableCell(data, headers, table_align=table_align, cell_align=cell_align, style=style, caption=caption)
        html = str(table)
        assert html.startswith(f"<table align={table_align}")
        assert html.endswith("</table>")
        if style:
            assert f'style="{style}"' in html
        if caption:
            assert f'<caption style="text-align: left; padding-bottom: 15px;">{caption}</caption>' in html
        assert get_num_table_rows(str(table)) == len(data) + 1  # + 1 for header row

        # assert all headers are present
        for i, header in enumerate(headers):
            header_cell = (
                f'<th style="text-align: {cell_align};">{header}</th>'
                if cell_align and i != 0
                else f"<th >{header}</th>"
            )
            assert header_cell in html

        # assert every row in `data` is present in the HTML
        for row in data:
            for i, elem in enumerate(row):
                table_cell = (
                    f'<td style="text-align: {cell_align};">{elem}</td>'
                    if cell_align and i != 0
                    else f"<td >{elem}</td>"
                )
                assert table_cell in html

    def test_table_cell_init_mismatch(self):
        """
        GIVEN `data` and `column_names` arguments that have mismatching lengths
        WHEN a TableCell is created
        THEN an exception is raised
        """
        with pytest.raises(AssertionError, match=r"Number of headers in"):
            TableCell(data=[[1, 2, 3], [4, 5, 6]], headers=["col_1", "col_2"], table_align=LEFT, cell_align=LEFT)

    @pytest.mark.parametrize(
        "kwargs, expected",
        [
            ({}, BAR_PLOT_CELL_NO_ARGS),
            ({"color": ["blue", "blue", "red"], "title": "Blue and Red"}, BAR_PLOT_CELL_WITH_ARGS),
        ],
    )
    def test_bar_plot_cell_init_success(self, kwargs, expected):
        """
        GIVEN valid `labels` and `heights` initializer arguments
        WHEN a BarPlotCell is created
        THEN the str representation of the BarPlotCell object matches what is expected

        NOTE: we do not perform validation of str(bar_plot) like we do in the
        other test functions due to an extremely strange bug.
        TODO: Investigate bug and add validation.
        """
        BarPlotCell(["a", "b", "c"], [1, 2.0, 3], **kwargs)

    def test_bar_plot_cell_init_failure(self):
        """
        GIVEN `labels` and `heights` arguments that have mismatching lengths
        WHEN a BarPlotCell is created
        THEN an exception is raised
        """
        with pytest.raises(AssertionError, match=r"Number of labels"):
            BarPlotCell(["a", "b", "c"], [1, 2], "Title")
